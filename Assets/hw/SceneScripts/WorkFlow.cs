using UnityEngine;
using UnityEngine.SceneManagement;

/// <summary>
/// 해당 클래스는 0407 Managers에서 GameManager로 대체함, 추후 해당 스크립트가 필요시를 대비해 삭제는 X
/// </summary>
public class WorkFlow :MonoBehaviour
{
        Define.SceneType sceneType = Define.SceneType.None;

    WorkFlow _instance;
    public WorkFlow Instance => _instance;
    private void Awake()
    {
        if (_instance == null)
            _instance = this;
        else
            Destroy(_instance);
     
        DontDestroyOnLoad(this);
    }
    public void Update()
        {
            ProgramWorkFlow();
        }

        public void ProgramWorkFlow()
        {
            switch (sceneType)
            {
                case Define.SceneType.None:
                    {
                        Managers.Scene.LoadScene(Define.SceneType.LoginScene);
                        //SceneManager.LoadScene("LoginScene");
                        sceneType++;
                    }
                    break;
                case Define.SceneType.LoginScene:
                    {
                        if (LoginInformation.loggedIn && LoginInformation.profile != null)//로그인이 된상태 + 로그인이 돼서 프로파일이 생긴다면 로비로 입장
                        {
                            //Todo Create Class LoginInfomation.loggedin, LoginInfomation.profile 
                            if (PhotonManager.instance) //포톤 매니저 인스턴스가 생기면 로그인
                            {
                                Managers.Scene.LoadScene(Define.SceneType.LobbyScene);
                                //SceneManager.LoadScene("LobbyScene");
                                sceneType++;
                            }
                        }
                    }
                    break;
                case Define.SceneType.LobbyScene:
                    //TODO: 로비에 있을때 마스터 유저가 Start버튼을 누르면 Game씬으로 전환 되게끔 작성
                    break;
                case Define.SceneType.GamePlay:
                    break;
                default:
                    break;
            }
        }
    }

